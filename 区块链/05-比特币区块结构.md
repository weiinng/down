# 3.6比特币区块结构

## 区块结构

| 字节 | 字段       | 说明                                                         |
| ---- | ---------- | ------------------------------------------------------------ |
| 4    | 区块大小   | 用字节表示该字段之后的区块大小                               |
| 80   | 区块头     | 组成区块头的几个字段                                         |
| 1-9  | 交易计数器 | 该区块的交易数量，包含coinbase交易                           |
| 不定 | 交易       | 记录在区块里交易的信息，使用原生的交易信息格式，并且交易在数据流中的位置必须与Merkle树的叶子节点顺序一致。 |

<font color='red'>注意：比特币的区块大小目前严格限制在1M左右。4字节的区块大小字段不包含在此内。</font>

## 区块头

**区块头（Block Header）**

| 字节 | 字段           | 说明                                                         |
| ---- | -------------- | ------------------------------------------------------------ |
| 4    | 版本           | 区块版本号，表示本区块遵守的验证规则                         |
| 32   | 父区块头哈希值 | 去一区块的哈希值，使用SHA256（SHA256（父区块头））计算       |
| 32   | Merkle根       | 该区块中交易的Merkle树根的哈希值，同样采用SHA256（SHA256（））计算 |
| 44   | 时间戳         | 该区块产生的近似时间，精确到秒的UNIX时间戳，必须严格大于前11个区块时间的中值，同时全节点也会拒绝那些超出自己两小时时间戳的区块。 |
| 4    | 难度目标       | 该区块工作量证明算法的难度目标，已经使用特定算法编码。       |
| 4    | Nonce          | 为了找到满足目标所设定的随机数，为了解决32随机数在算力飞升情况下不够用的问题，规定时间戳和coinbase交易信息均可更改，以此拓展nonce的位数。 |

<font color='red'>注意：区块不存储hash值，节点接收块区后独立计算并存储本地</font>

## 区块体

- Coinbase交易、第一条交易，挖矿建立矿工

- 普通转账交易

  每笔交易包括付款方、收款方、付款金额、手续费等等



## 区块完整图









V1版本思路：

**区块相关：**

1. 定义一个区块结构 Biock
   - 区块头 ：六个字段
   - 区块体：字符串表示data
2. 提供一个创建区块的方法
   - NewBlock（参数）

**区块链相关：**

1. 定义一个区块链结构BlockChain

   Block数组

2. 提供一个创建Blockchain的方法

   NewBlockChain()

3. 提供一个添加区块的方法

   AddBlock(参数)

















